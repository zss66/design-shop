import{_ as U,t as q,r as F,u as j,v as z,g as B,x as R,y as G,k as c,o as A,z as D,b as f,h as y,e as l,w as a,E as M,j as u,c as $,A as H,B as b,C as L,n as O,m as T,D as J,F as K,G as Q,H as W,q as X,i as Y}from"./index-CwP9YyYn.js";/* empty css             *//* empty css                  *//* empty css              *//* empty css              *//* empty css                 *//* empty css                  */const Z={class:"add"},oo=["src"],eo={__name:"AddGood",setup(lo){const{proxy:h}=q();F(null);const _=F(null),v=j(),I=z(),{id:g}=v.query,o=B({uploadImgServer:R,token:G("token")||"",id:g,defaultCate:"",goodForm:{goodsName:"",goodsIntro:"",originalPrice:"",sellingPrice:"",stockNum:"",goodsSellStatus:"0",goodsCoverImg:"",tag:2},rules:{goodsName:[{required:"true",message:"请填写商品名称",trigger:["change"]}],originalPrice:[{required:"true",message:"请填写商品价格",trigger:["change"]}],sellingPrice:[{required:"true",message:"请填写商品售价",trigger:["change"]}],stockNum:[{required:"true",message:"请填写商品库存",trigger:["change"]}]},categoryId:"",category:{lazy:!0,lazyLoad(r,e){const{level:d=0,value:s}=r;c.get("/foo/goods/class",{params:{shopid:1,pageNumber:1,pageSize:1e3}}).then(n=>{const i=n.list.map(p=>({value:p.id,label:p.name,leaf:d==0}));e(i)})}}});A(()=>{g&&c.get("/foo/goods/detail",{params:{id:g}}).then(r=>{const{goods:e}=r;console.log(e),o.goodForm={goodsName:e.name,goodsIntro:e.dec,originalPrice:e.price,sellingPrice:e.newprice,stockNum:e.offernum,goodsSellStatus:String(e.offer),goodsCoverImg:h.$filters.prefix(e.img),tag:e.type},o.categoryId=e.classid,o.defaultCate=e.classname})});const V=()=>{_.value.validate(r=>{if(r){let e=c.post,d={classid:o.categoryId,img:o.goodForm.goodsCoverImg,dec:o.goodForm.goodsIntro,name:o.goodForm.goodsName,offer:o.goodForm.goodsSellStatus,price:o.goodForm.originalPrice,newprice:o.goodForm.sellingPrice,num:o.goodForm.stockNum,type:o.goodForm.tag};console.log("params",d),g&&(d.id=g),e("/foo/goods/change",d).then(()=>{b.success(g?"修改成功":"添加成功"),I.push({path:"/good"})})}})},x=r=>{const e=r.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(e))return b.error("请上传 jpg、jpeg、png 格式的图片"),!1},C=r=>{o.goodForm.goodsCoverImg=r.data||""},k=r=>{console.log(r),o.categoryId=r[2]||0};return(r,e)=>{const d=L,s=O,n=T,m=J,i=K,p=D("Plus"),N=Q,S=W,P=X,w=Y,E=M;return f(),y("div",Z,[l(E,{class:"add-container"},{default:a(()=>[l(w,{model:o.goodForm,rules:o.rules,ref_key:"goodRef",ref:_,"label-width":"100px",class:"goodForm"},{default:a(()=>[l(s,{required:"",label:"商品分类"},{default:a(()=>[l(d,{placeholder:o.defaultCate,style:{width:"300px"},props:o.category,onChange:k},null,8,["placeholder","props"])]),_:1}),l(s,{label:"商品名称",prop:"goodsName"},{default:a(()=>[l(n,{style:{width:"300px"},modelValue:o.goodForm.goodsName,"onUpdate:modelValue":e[0]||(e[0]=t=>o.goodForm.goodsName=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1}),l(s,{label:"商品简介",prop:"goodsIntro"},{default:a(()=>[l(n,{style:{width:"300px"},type:"textarea",modelValue:o.goodForm.goodsIntro,"onUpdate:modelValue":e[1]||(e[1]=t=>o.goodForm.goodsIntro=t),placeholder:"请输入商品简介(100字)"},null,8,["modelValue"])]),_:1}),l(s,{label:"商品价格",prop:"originalPrice"},{default:a(()=>[l(n,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.originalPrice,"onUpdate:modelValue":e[2]||(e[2]=t=>o.goodForm.originalPrice=t),placeholder:"请输入商品价格"},null,8,["modelValue"])]),_:1}),l(s,{label:"商品售卖价",prop:"sellingPrice"},{default:a(()=>[l(n,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.sellingPrice,"onUpdate:modelValue":e[3]||(e[3]=t=>o.goodForm.sellingPrice=t),placeholder:"请输入商品售价"},null,8,["modelValue"])]),_:1}),l(s,{label:"商品库存",prop:"stockNum"},{default:a(()=>[l(n,{type:"number",min:"0",style:{width:"300px"},modelValue:o.goodForm.stockNum,"onUpdate:modelValue":e[4]||(e[4]=t=>o.goodForm.stockNum=t),placeholder:"请输入商品库存"},null,8,["modelValue"])]),_:1}),l(s,{label:"中餐专用标记",prop:"tag"},{default:a(()=>[l(i,{modelValue:o.goodForm.tag,"onUpdate:modelValue":e[5]||(e[5]=t=>o.goodForm.tag=t)},{default:a(()=>[l(m,{value:0,size:"large",border:""},{default:a(()=>[u("中式素菜")]),_:1}),l(m,{value:1,size:"large",border:""},{default:a(()=>[u("中式荤菜")]),_:1}),l(m,{value:2,size:"large",border:""},{default:a(()=>[u("其他")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"上架状态",prop:"goodsSellStatus"},{default:a(()=>[l(i,{modelValue:o.goodForm.goodsSellStatus,"onUpdate:modelValue":e[6]||(e[6]=t=>o.goodForm.goodsSellStatus=t)},{default:a(()=>[l(m,{label:"0"},{default:a(()=>[u("上架")]),_:1}),l(m,{label:"1"},{default:a(()=>[u("下架")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(s,{required:"",label:"商品主图",prop:"goodsCoverImg"},{default:a(()=>[l(S,{class:"avatar-uploader",action:"http://121.36.193.95:3000/api/uploadimg",accept:"jpg,jpeg,png","show-file-list":!1,"before-upload":x,"on-success":C},{default:a(()=>[o.goodForm.goodsCoverImg?(f(),y("img",{key:0,style:{width:"100px",height:"100px",border:"1px solid #e9e9e9"},src:o.goodForm.goodsCoverImg,class:"avatar"},null,8,oo)):(f(),$(N,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[l(p)]),_:1}))]),_:1})]),_:1}),l(s,null,{default:a(()=>[l(P,{type:"primary",onClick:e[7]||(e[7]=t=>V())},{default:a(()=>[u(H(o.id?"立即修改":"立即创建"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}},uo=U(eo,[["__scopeId","data-v-404f8717"]]);export{uo as default};
