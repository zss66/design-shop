import{r as E,u as w,g as S,b as V,c as P,w as n,d as g,e as a,j as h,k as c,B as p,m as R,n as $,i as U,q as B,I as q,v as I,o as M,R as A,a as O,E as j,K as F,L as K,M as L,N as Q,O as G,P as H,Q as J}from"./index-CwP9YyYn.js";/* empty css             *//* empty css               *//* empty css              *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const W={class:"dialog-footer"},X={__name:"DialogAddCategory",props:{type:String,reload:Function},setup(C,{expose:u}){const d=C,t=E(null);w();const e=S({visible:!1,ruleForm:{name:"",rank:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],rank:[{required:"true",message:"编号不能为空",trigger:["change"]}]},id:""}),i=s=>{c.get("/foo/goods/class",{params:{id:s}}).then(l=>{e.ruleForm={name:l[0].name,rank:l[0].order}}).catch(l=>{console.error("发生错误：",l)})},b=s=>{e.visible=!0,s?(e.id=s,i(s)):e.ruleForm={name:"",rank:""}},y=()=>{e.visible=!1},k=()=>{t.value.validate(s=>{s&&(d.type=="add"?c.post("/foo/goods/classedit",{name:e.ruleForm.name,order:e.ruleForm.rank}).then(()=>{p.success("添加成功"),e.visible=!1,d.reload&&d.reload()}):c.post("/foo/goods/classedit",{id:e.id,name:e.ruleForm.name,order:e.ruleForm.rank}).then(()=>{p.success("修改成功"),e.visible=!1,d.reload&&d.reload()}))})};return u({open:b,close:y}),(s,l)=>{const f=R,o=$,v=U,m=B,_=q;return V(),P(_,{title:e.type=="add"?"添加分类":"修改分类",modelValue:e.visible,"onUpdate:modelValue":l[3]||(l[3]=r=>e.visible=r),width:"400px"},{footer:n(()=>[g("span",W,[a(m,{onClick:l[2]||(l[2]=r=>e.visible=!1)},{default:n(()=>[h("取 消")]),_:1}),a(m,{type:"primary",onClick:k},{default:n(()=>[h("确 定")]),_:1})])]),default:n(()=>[a(v,{model:e.ruleForm,rules:e.rules,ref_key:"formRef",ref:t,"label-width":"100px",class:"good-form"},{default:n(()=>[a(o,{label:"商品名称",prop:"name"},{default:n(()=>[a(f,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=r=>e.ruleForm.name=r)},null,8,["modelValue"])]),_:1}),a(o,{label:"排序值",prop:"rank"},{default:n(()=>[a(f,{type:"number",modelValue:e.ruleForm.rank,"onUpdate:modelValue":l[1]||(l[1]=r=>e.ruleForm.rank=r)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}},Y={class:"header"},Z=["onClick"],ee=g("a",{style:{cursor:"pointer"}},"删除",-1),ue={__name:"Category",setup(C){const u=E(null),d=I();w();const t=S({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",parent_id:0});M(()=>{i()}),A(()=>{console.log(t.pageSize)});const e=d.afterEach(o=>{["category"].includes(o.name)&&i()});O(()=>{e()});const i=()=>{t.loading=!0,c.get("/foo/goods/class",{params:{pageNumber:t.currentPage,pageSize:t.pageSize}}).then(o=>{t.tableData=o.list,t.total=o.totalCount,t.currentPage=o.currPage,t.loading=!1})},b=o=>{t.currentPage=o,i()},y=()=>{t.type="add",u.value.open()},k=o=>{console.log(o),t.type="edit",u.value.open(o)},s=o=>{t.multipleSelection=o},l=()=>{if(!t.multipleSelection.length){p.error("请选择项");return}c.delete("/foo/goods/classdelete",{data:{ids:t.multipleSelection.map(o=>o.id)}}).then(()=>{p.success("删除成功"),i()})},f=o=>{c.delete("/foo/goods/classdelete",{data:{ids:[o]}}).then(()=>{p.success("删除成功"),i()})};return(o,v)=>{const m=B,_=K,r=L,D=Q,T=G,z=j;return V(),P(z,{class:"category-container"},{header:n(()=>[g("div",Y,[a(m,{type:"primary",icon:F(H),onClick:y},{default:n(()=>[h("增加")]),_:1},8,["icon"]),a(_,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:l},{reference:n(()=>[a(m,{type:"danger",icon:F(J)},{default:n(()=>[h("批量删除")]),_:1},8,["icon"])]),_:1})])]),default:n(()=>[a(D,{load:t.loading,ref:"multipleTable",data:t.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:s},{default:n(()=>[a(r,{type:"selection",width:"55"}),a(r,{prop:"name",label:"分类名称"}),a(r,{prop:"order",label:"排序值",width:"120"}),a(r,{prop:"time",label:"修改时间",width:"200"}),a(r,{label:"操作",width:"220"},{default:n(x=>[g("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:N=>k(x.row.id)},"修改",8,Z),a(_,{title:"确定删除吗？",confirmButtonText:"确定",cancelButtonText:"取消",onConfirm:N=>f(x.row.id)},{reference:n(()=>[ee]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["load","data"]),a(T,{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onCurrentChange:b},null,8,["total","page-size","current-page"]),a(X,{ref_key:"addCate",ref:u,reload:i,type:t.type},null,8,["type"])]),_:1})}}};export{ue as default};
