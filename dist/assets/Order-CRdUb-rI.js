import{g as D,o as M,k as m,z as T,b as n,c as p,w as r,E as L,d as _,e as a,h as g,S as U,J as q,j as c,K as h,A as j,T as y,B as d,m as A,U as F,q as I,M as J,L as K,N as Q,O as W,V as x,Q as G,W as H}from"./index-CwP9YyYn.js";/* empty css             *//* empty css               *//* empty css              *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   */const R={class:"header"},X={key:0},Y={key:1},Z={key:2},ee=_("a",{style:{cursor:"pointer","margin-right":"10px"}},"接单",-1),te=_("a",{style:{cursor:"pointer","margin-right":"10px"}},"出餐",-1),oe=_("a",{style:{cursor:"pointer","margin-right":"10px"}},"关闭订单",-1),ce={__name:"Order",setup(le){const e=D({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,orderNo:"",order_status:"",options:[{value:"",label:"全部"},{value:2,label:"待支付"},{value:3,label:"已支付"},{value:4,label:"接单完成"},{value:5,label:"出餐成功"},{value:7,label:"交易成功"},{value:-1,label:"手动关闭"},{value:0,label:"超时关闭"},{value:-3,label:"商家关闭"}]});M(()=>{u()});const u=()=>{e.loading=!0,m.get("/foo/order/list",{params:{pageNumber:e.currentPage,pageSize:e.pageSize,orderNo:e.orderNo,order_status:e.order_status}}).then(l=>{console.log(l),e.tableData=l.list,e.total=l.totalCount,e.currentPage=l.currPage,e.loading=!1})},v=()=>{e.currentPage=1,u()},E=l=>{e.multipleSelection=l},N=l=>{e.currentPage=l,u()},C=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){console.log("state.multipleSelection",e.multipleSelection.length),d.error("请选择项");return}o=e.multipleSelection.map(s=>s.order_id)}m.put("/foo/orders/checkDone",{ids:o}).then(()=>{d.success("接单成功"),u()})},k=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){d.error("请选择项");return}o=e.multipleSelection.map(s=>s.order_id)}m.put("/orders/checkOut",{ids:o}).then(()=>{d.success("出餐成功"),u()})},w=l=>{let o;if(l)o=[l];else{if(!e.multipleSelection.length){d.error("请选择项");return}o=e.multipleSelection.map(s=>s.order_id)}m.put("/orders/close",{ids:o}).then(()=>{d.success("关闭成功"),u()})};return(l,o)=>{const s=A,V=H,P=F,f=I,i=J,b=K,z=T("router-link"),$=Q,B=W,O=L;return n(),p(O,{class:"order-container"},{header:r(()=>[_("div",R,[a(s,{style:{width:"200px","margin-right":"10px"},placeholder:"请输入订单号",modelValue:e.orderNo,"onUpdate:modelValue":o[0]||(o[0]=t=>e.orderNo=t),onChange:v,clearable:""},null,8,["modelValue"]),a(P,{onChange:v,modelValue:e.order_status,"onUpdate:modelValue":o[1]||(o[1]=t=>e.order_status=t),style:{width:"200px","margin-right":"10px"}},{default:r(()=>[(n(!0),g(q,null,U(e.options,t=>(n(),p(V,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(f,{type:"primary",icon:h(x),onClick:o[2]||(o[2]=t=>C())},{default:r(()=>[c("接单")]),_:1},8,["icon"]),a(f,{type:"primary",icon:h(x),onClick:o[3]||(o[3]=t=>k())},{default:r(()=>[c("出餐")]),_:1},8,["icon"]),a(f,{type:"danger",icon:h(G),onClick:o[4]||(o[4]=t=>w())},{default:r(()=>[c("关闭订单")]),_:1},8,["icon"])])]),default:r(()=>[a($,{load:e.loading,data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:E},{default:r(()=>[a(i,{type:"selection",width:"55"}),a(i,{prop:"order_id",label:"订单号"}),a(i,{prop:"goods_price",label:"商品单价"}),c(),a(i,{prop:"goods_num",label:"订单数量"}),a(i,{prop:"order_status",label:"订单状态"},{default:r(t=>[_("span",null,j(l.$filters.orderMap(t.row.order_status)),1)]),_:1}),a(i,{prop:"payway",label:"支付方式"},{default:r(t=>[t.row.payway==1?(n(),g("span",X,"微信支付")):t.row.payway==2?(n(),g("span",Y,"支付宝支付")):(n(),g("span",Z,"未知"))]),_:1}),a(i,{label:"操作"},{default:r(t=>[t.row.order_status==3?(n(),p(b,{key:0,title:"确定接单完成吗？",onConfirm:S=>C(t.row.order_id),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[ee]),_:2},1032,["onConfirm"])):y("",!0),t.row.order_status==4?(n(),p(b,{key:1,title:"确定出餐吗？",onConfirm:S=>k(t.row.order_id),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[te]),_:2},1032,["onConfirm"])):y("",!0),t.row.order_status==6||t.row.order_status<0?y("",!0):(n(),p(b,{key:2,title:"确定关闭订单吗？",onConfirm:S=>w(t.row.order_id),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:r(()=>[oe]),_:2},1032,["onConfirm"])),a(z,{to:{path:"/order_detail",query:{id:t.row.order_id}}},{default:r(()=>[c("订单详情")]),_:2},1032,["to"])]),_:1})]),_:1},8,["load","data"]),a(B,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:N},null,8,["total","page-size","current-page"])]),_:1})}}};export{ce as default};
